#include <Arduino.h>

const uint16_t MIN_MV = 17;
const uint16_t MAX_MV = 790;

const uint8_t OPTIMAL_BIAS[773] = {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
                                   1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 
                                   2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 
                                   2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 
                                   2, 2, 2, 2, 3, 2, 2, 3, 2, 3, 
                                   3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 
                                   3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 
                                   3, 3, 3, 3, 3, 3, 4, 3, 4, 4, 
                                   3, 4, 4, 3, 3, 4, 3, 3, 3, 4, 
                                   4, 4, 4, 3, 3, 3, 3, 3, 3, 3, 
                                   4, 4, 4, 3, 4, 5, 5, 3, 3, 3, 
                                   3, 5, 4, 3, 4, 4, 4, 5, 5, 4, 
                                   4, 5, 4, 4, 4, 4, 4, 5, 5, 5, 
                                   4, 4, 5, 5, 4, 6, 5, 6, 5, 5, 
                                   5, 4, 6, 6, 5, 4, 4, 6, 4, 4, 
                                   5, 6, 4, 5, 5, 5, 4, 4, 4, 4, 
                                   6, 5, 6, 6, 4, 5, 5, 6, 4, 4, 
                                   6, 5, 5, 7, 6, 7, 5, 5, 6, 4, 
                                   4, 7, 5, 5, 7, 5, 6, 7, 5, 5, 
                                   6, 6, 5, 5, 6, 7, 8, 7, 5, 7, 
                                   5, 7, 6, 5, 5, 8, 6, 8, 7, 5, 
                                   6, 8, 5, 5, 6, 5, 5, 7, 6, 7, 
                                   5, 7, 6, 5, 8, 6, 6, 9, 7, 9, 
                                   7, 5, 5, 6, 9, 8, 5, 8, 5, 9, 
                                   6, 7, 5, 5, 5, 7, 6, 7, 7, 6, 
                                   6, 9, 8, 6, 7, 6, 9, 6, 10, 9, 
                                   8, 10, 6, 7, 6, 7, 9, 8, 10, 8, 
                                   6, 10, 7, 6, 7, 10, 7, 6, 9, 7, 
                                   6, 10, 8, 9, 8, 6, 8, 11, 9, 6, 
                                   9, 10, 6, 6, 11, 8, 7, 6, 7, 8, 
                                   9, 6, 7, 11, 10, 6, 6, 10, 8, 6, 
                                   9, 11, 8, 7, 10, 7, 8, 10, 11, 11, 
                                   7, 8, 7, 8, 7, 12, 11, 8, 7, 8, 
                                   12, 7, 9, 7, 11, 12, 8, 10, 8, 9, 
                                   10, 11, 8, 11, 7, 12, 8, 10, 7, 9, 
                                   11, 11, 13, 7, 9, 7, 9, 8, 11, 9, 
                                   10, 8, 7, 10, 12, 11, 11, 13, 7, 12, 
                                   10, 9, 8, 11, 8, 7, 9, 7, 12, 12, 
                                   10, 9, 8, 10, 12, 8, 9, 8, 12, 8, 
                                   10, 8, 13, 12, 8, 8, 13, 11, 12, 10, 
                                   8, 9, 8, 9, 8, 11, 10, 13, 8, 10, 
                                   9, 13, 12, 9, 11, 8, 10, 8, 9, 8, 
                                   9, 11, 13, 9, 8, 9, 10, 12, 9, 10, 
                                   9, 11, 8, 13, 8, 9, 10, 11, 11, 10, 
                                   9, 12, 12, 8, 13, 11, 11, 9, 13, 10, 
                                   12, 12, 10, 11, 11, 13, 12, 9, 13, 13, 
                                   11, 11, 10, 10, 9, 10, 12, 11, 11, 11, 
                                   12, 9, 10, 13, 9, 12, 12, 13, 10, 9, 
                                   12, 9, 10, 11, 11, 10, 9, 9, 13, 9, 
                                   12, 9, 11, 9, 9, 12, 9, 10, 10, 13, 
                                   12, 9, 10, 9, 9, 12, 13, 13, 10, 11, 
                                   12, 10, 10, 13, 12, 12, 11, 11, 10, 12, 
                                   10, 13, 10, 11, 11, 13, 11, 10, 10, 12, 
                                   11, 10, 11, 11, 10, 10, 13, 11, 10, 12, 
                                   11, 10, 11, 13, 13, 10, 11, 13, 11, 12, 
                                   13, 10, 12, 12, 10, 11, 11, 10, 13, 12, 
                                   11, 10, 13, 12, 10, 13, 10, 12, 10, 13, 
                                   10, 11, 11, 12, 10, 10, 13, 12, 12, 11, 
                                   13, 13, 12, 13, 13, 11, 11, 11, 12, 12, 
                                   13, 13, 12, 11, 11, 11, 12, 12, 13, 12, 
                                   11, 12, 12, 11, 12, 11, 12, 13, 12, 13, 
                                   11, 11, 12, 13, 13, 12, 12, 11, 11, 11, 
                                   11, 12, 12, 12, 13, 11, 12, 11, 13, 11, 
                                   12, 12, 13, 11, 11, 11, 12, 12, 13, 12, 
                                   12, 12, 11, 13, 12, 12, 13, 13, 12, 13, 
                                   13, 12, 12, 13, 13, 12, 13, 13, 12, 12, 
                                   12, 13, 12, 12, 13, 12, 13, 13, 13, 12, 
                                   13, 12, 13, 13, 12, 12, 13, 13, 12, 13, 
                                   13, 13, 13, 13, 12, 12, 13, 13, 12, 12, 
                                   13, 12, 12, 12, 13, 12, 13, 13, 12, 12, 
                                   12, 13, 12, 12, 13, 13, 13, 12, 12, 13, 
                                   13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 
                                   13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 
                                   13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 
                                   13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 
                                   13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 
                                   13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 
                                   13, 13, 13, };

const uint16_t DAC_BINARY[773] = {44565, 47187, 49808, 52430, 55051, 57673, 60294, 62916, 65537, 68158, 
                                  70780, 73401, 76023, 78644, 81266, 41944, 43255, 44565, 45876, 47187, 
                                  48498, 49808, 51119, 52430, 53741, 55051, 56362, 57673, 58983, 60294, 
                                  61605, 62916, 64226, 65537, 66848, 68158, 69469, 70780, 72091, 73401, 
                                  74712, 76023, 77333, 78644, 39978, 81266, 82576, 41944, 85198, 43255, 
                                  43910, 44565, 45221, 45876, 46532, 47187, 47842, 48498, 49153, 49808, 
                                  50464, 51119, 51774, 52430, 53085, 53741, 54396, 55051, 55707, 56362, 
                                  57017, 57673, 58328, 58983, 59639, 60294, 40633, 61605, 41507, 41944, 
                                  63571, 42818, 43255, 65537, 66192, 44565, 67503, 68158, 68814, 46313, 
                                  46750, 47187, 47624, 72091, 72746, 73401, 74057, 74712, 75367, 76023, 
                                  51119, 51556, 51993, 78644, 52867, 39978, 40306, 81266, 81921, 82576, 
                                  83232, 41944, 56362, 85198, 57236, 57673, 58110, 43910, 44238, 59420, 
                                  59857, 45221, 60731, 61168, 61605, 62042, 62479, 47187, 47515, 47842, 
                                  64226, 64663, 48825, 49153, 65974, 39847, 50136, 40371, 50791, 51119, 
                                  51447, 69032, 41682, 41944, 52757, 70780, 71217, 42993, 72091, 72528, 
                                  54724, 44041, 73838, 55707, 56034, 56362, 75586, 76023, 76460, 76897, 
                                  46400, 58328, 46925, 47187, 79081, 59639, 59966, 48235, 80829, 81266, 
                                  49022, 61605, 61933, 41507, 50071, 41944, 63243, 63571, 51119, 85635, 
                                  86072, 43255, 65209, 65537, 43910, 66192, 53216, 44565, 67175, 67503, 
                                  54265, 54527, 68486, 68814, 55313, 46313, 39884, 46750, 70452, 47187, 
                                  71108, 47624, 57411, 72091, 72418, 41570, 58459, 41944, 49153, 74057, 
                                  59508, 42693, 75040, 75367, 60556, 76023, 76350, 51119, 61605, 51556, 
                                  77661, 51993, 62653, 78644, 45127, 63440, 63702, 39978, 53522, 40306, 
                                  53959, 81266, 81593, 65537, 41125, 47187, 82904, 47561, 83559, 41944, 
                                  67372, 56362, 84870, 85198, 85525, 57236, 68945, 57673, 57891, 69731, 
                                  69993, 43910, 50370, 70780, 59202, 71304, 44729, 71828, 40051, 45221, 
                                  51868, 40488, 73139, 61168, 73663, 61605, 46368, 53179, 41507, 53553, 
                                  75236, 41944, 63134, 76023, 63571, 42527, 64008, 77071, 48334, 64663, 
                                  77858, 43400, 55987, 49153, 56362, 79168, 56736, 39847, 49972, 80217, 
                                  50300, 44857, 81003, 81266, 40764, 58422, 68377, 82314, 68814, 59171, 
                                  51938, 83363, 69688, 41944, 46750, 84411, 84674, 47187, 60856, 85460, 
                                  53577, 42993, 61605, 72091, 48206, 72528, 62354, 48643, 43910, 44041, 
                                  73620, 63290, 74057, 63665, 74494, 40752, 44959, 64414, 75367, 64788, 
                                  41348, 76023, 57181, 76460, 46007, 41944, 66099, 51556, 66473, 58328, 
                                  51993, 46925, 67222, 47187, 78863, 43136, 67971, 53012, 79736, 59966, 
                                  48104, 48235, 40306, 80829, 60786, 81266, 61113, 70031, 49153, 61605, 
                                  54906, 70780, 82795, 55343, 45400, 50071, 50202, 41944, 84106, 45995, 
                                  56362, 63571, 72840, 51119, 73214, 85635, 64390, 86072, 47068, 47187, 
                                  57818, 65209, 74712, 58255, 47783, 75274, 66029, 75648, 48259, 76023, 
                                  59275, 76397, 44675, 48855, 76959, 77146, 45112, 54265, 49451, 60585, 
                                  78082, 68486, 78457, 68814, 78831, 55313, 61605, 46313, 79580, 62042, 
                                  69961, 46750, 51119, 70452, 56493, 80891, 63061, 81266, 71271, 81640, 
                                  71599, 57411, 47952, 72091, 82576, 72418, 64518, 52906, 72910, 64954, 
                                  73237, 58721, 84074, 49153, 84449, 74057, 65974, 59508, 59639, 66411, 
                                  74876, 54575, 54694, 86134, 50354, 60556, 60687, 76023, 50791, 67867, 
                                  55647, 55766, 68304, 61605, 61736, 51556, 56362, 77661, 51884, 51993, 
                                  62522, 62653, 69760, 69906, 78808, 70197, 57554, 63440, 63571, 63702, 
                                  58030, 79955, 71217, 53522, 80446, 58626, 58745, 53959, 72091, 81266, 
                                  59222, 81593, 72673, 65537, 65668, 73110, 82413, 82576, 55160, 82904, 
                                  60413, 83232, 66717, 83559, 83723, 61009, 84051, 74858, 75003, 56362, 
                                  61605, 84870, 75586, 85198, 85362, 62201, 57127, 57236, 76460, 68945, 
                                  62796, 76897, 77042, 57891, 63273, 63392, 69862, 69993, 77916, 63869, 
                                  78207, 58765, 78499, 70780, 70911, 59202, 71173, 79227, 79372, 65060, 
                                  71697, 79809, 71960, 72091, 80246, 80392, 60403, 72615, 80829, 66252, 
                                  73008, 81266, 73270, 61168, 61277, 81848, 73795, 61605, 74057, 67444, 
                                  61933, 82722, 67801, 67920, 83159, 74974, 75105, 83596, 62806, 68635, 
                                  75630, 84178, 63243, 69112, 84615, 63571, 84907, 69588, 85198, 64008, 
                                  85489, 77071, 77202, 70303, 86072, 86217, 64772, 70780, 70899, 78120, 
                                  65209, 65319, 71376, 65537, 65646, 78906, 79037, 79168, 72091, 72210, 
                                  66302, 66411, 72567, 79955, 80086, 80217, 73044, 73163, 67175, 73401, 
                                  80872, 73640, 73759, 81266, 73997, 81528, 74235, 68158, 74474, 68377, 
                                  82183, 82314, 74950, 68814, 68923, 75308, 75427, 83101, 83232, 83363, 
                                  83494, 76023, 76142, 76261, 70015, 84149, 76619, 84411, 70452, 84674, 
                                  77095, 77214, 70889, 85198, 85329, 85460, 77810, 77929, 71544, 78168, 
                                  78287, 78406, 86377, 72091, 78763, 78883, 72418, 72528, 79240, 72746, 
                                  72855, 79597, 79717, 73183, 73292, 80074, 73511, 73620, 80432, 80551, 
                                  80670, 74057, 80908, 81027, 74384, 81266, 74603, 74712, 74821, 81742, 
                                  75040, 81981, 75258, 75367, 82338, 82457, 75695, 75804, 82815, 76023, 
                                  76132, 76241, 76350, 76460, 83530, 83649, 76787, 76897, 84006, 84125, 
                                  77224, 84364, 84483, 84602, 77661, 84840, 77880, 77989, 85198, 85317, 
                                  85436, 78426, 85674, 85794, 78753, 78863, 78972, 86270, 86389, 79300, 
                                  79409, 79518, 79627, 79736, 79846, 79955, 80064, 80173, 80283, 80392, 
                                  80501, 80610, 80720, 80829, 80938, 81047, 81156, 81266, 81375, 81484, 
                                  81593, 81703, 81812, 81921, 82030, 82139, 82249, 82358, 82467, 82576, 
                                  82686, 82795, 82904, 83013, 83122, 83232, 83341, 83450, 83559, 83669, 
                                  83778, 83887, 83996, 84106, 84215, 84324, 84433, 84542, 84652, 84761, 
                                  84870, 84979, 85089, 85198, 85307, 85416, 85525, 85635, 85744, 85853, 
                                  85962, 86072, 86181, };

uint16_t get_index(uint16_t voltage) {
    return voltage - MIN_MV;
};